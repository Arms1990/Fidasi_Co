(this["webpackJsonpback-office"]=this["webpackJsonpback-office"]||[]).push([[8],{782:function(e,a,t){"use strict";var r=t(10),s=t(14),n=t(94),i=t(90),o=t(1),l=t.n(o),c=t(33),m=t.n(c),u=t(85),p=t.n(u),d=t(86),f={children:m.a.node,type:m.a.string,size:m.a.oneOfType([m.a.number,m.a.string]),bsSize:m.a.string,valid:m.a.bool,invalid:m.a.bool,tag:d.q,innerRef:m.a.oneOfType([m.a.object,m.a.func,m.a.string]),plaintext:m.a.bool,addon:m.a.bool,className:m.a.string,cssModule:m.a.object},h=function(e){function a(a){var t;return(t=e.call(this,a)||this).getRef=t.getRef.bind(Object(n.a)(t)),t.focus=t.focus.bind(Object(n.a)(t)),t}Object(i.a)(a,e);var t=a.prototype;return t.getRef=function(e){this.props.innerRef&&this.props.innerRef(e),this.ref=e},t.focus=function(){this.ref&&this.ref.focus()},t.render=function(){var e=this.props,a=e.className,t=e.cssModule,n=e.type,i=e.bsSize,o=e.valid,c=e.invalid,m=e.tag,u=e.addon,f=e.plaintext,h=e.innerRef,b=Object(s.a)(e,["className","cssModule","type","bsSize","valid","invalid","tag","addon","plaintext","innerRef"]),g=["radio","checkbox"].indexOf(n)>-1,E=new RegExp("\\D","g"),v=m||("select"===n||"textarea"===n?n:"input"),w="form-control";f?(w+="-plaintext",v=m||"input"):"file"===n?w+="-file":"range"===n?w+="-range":g&&(w=u?null:"form-check-input"),b.size&&E.test(b.size)&&(Object(d.s)('Please use the prop "bsSize" instead of the "size" to bootstrap\'s input sizing.'),i=b.size,delete b.size);var x=Object(d.m)(p()(a,c&&"is-invalid",o&&"is-valid",!!i&&"form-control-"+i,w),t);return("input"===v||m&&"function"===typeof m)&&(b.type=n),b.children&&!f&&"select"!==n&&"string"===typeof v&&"select"!==v&&(Object(d.s)('Input with a type of "'+n+'" cannot have children. Please use "value"/"defaultValue" instead.'),delete b.children),l.a.createElement(v,Object(r.a)({},b,{ref:h,className:x,"aria-invalid":c}))},a}(l.a.Component);h.propTypes=f,h.defaultProps={type:"text"},a.a=h},820:function(e,a,t){"use strict";t.r(a);var r=t(4),s=t.n(r),n=t(15),i=t(1),o=t.n(i),l=t(335),c=t(341),m=t(342),u=t(789),p=t(790),d=t(212),f=t(831),h=t(807),b=t(782),g=t(89),E=t(23),v=t(95),w=t(139),x=t(3),N=t(92),y=t(99),k=t(17);class O extends i.Component{constructor(e){var a;super(e),a=this,this.onUserLogin=function(){var e=Object(n.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.props.loading){e.next=4;break}if(""===t.email||""===t.password){e.next=4;break}return e.next=4,a.props.loginUser(t,a.props.history);case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),this.validateEmail=e=>{let a;return e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(a="Invalid email address"):a="Please enter your email address",a},this.validatePassword=e=>{let a;return e?e.length<3&&(a="Value must be longer than 2 characters"):a="Please enter your password",a},this.state={email:"",password:"",oneTimePassword:""},this.formickRef=o.a.createRef()}componentDidUpdate(){const e=this.props.error;e&&v.a.warning(e,"Login Error",3e3,null,null,"")}verifyUser(){var e=this;return Object(n.a)(s.a.mark((function a(){var t,r,n,i,o,l,c,m,u,p,d;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.props,r=t.authenticationServer,n=t.clientID,i=t.clientSecret,o=e.state.oneTimePassword,!e.formickRef){a.next=18;break}return l=e.formickRef.state.values,c=l.email,m=l.password,a.next=6,Object(k.a)("".concat(r,"/tfa/verify"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:c,password:m,client_id:n,client_secret:i,grant_type:"password",otp:o})});case 6:if((u=a.sent).ok){a.next=12;break}return a.next=10,u.json();case 10:return p=a.sent,a.abrupt("return",v.a.error(p.message||u.statusText,"Google Authenticator Error",3e3,null,null,""));case 12:return a.next=14,u.json();case 14:return d=a.sent,a.next=17,e.props.loginUserSuccess(d,e.props.history);case 17:return a.abrupt("return",a.sent);case 18:case"end":return a.stop()}}),a)})))()}render(){const e=this.state,a=e.password,t=e.email,r=this.props.showAuthenticator,s={email:t,password:a};return document.body.classList.add("rounded"),document.title="Login | Back Office",o.a.createElement(l.a,{className:"h-100"},o.a.createElement(N.a,{xxs:"12",md:"7",className:"mx-auto my-auto"},o.a.createElement(c.a,{className:"auth-card"},o.a.createElement("div",{className:"position-relative image-side "},o.a.createElement("p",{className:"text-white h2"},"MAGIC IS IN THE DETAILS"),o.a.createElement("p",{className:"white mb-0"},"Please use your credentials to login.",o.a.createElement("br",null),"If you are not a member, please"," ",o.a.createElement(g.b,{to:"/register",className:"white"},"register"),".")),o.a.createElement("div",{className:"form-side"},o.a.createElement(g.b,{to:"/",className:"white"},o.a.createElement("span",{className:"logo-single"})),o.a.createElement(m.a,{className:"mb-4"},o.a.createElement(y.a,{id:"user.login-title"})),o.a.createElement(w.c,{ref:e=>this.formickRef=e,initialValues:s,onSubmit:this.onUserLogin},({errors:e,touched:a})=>o.a.createElement(w.b,{className:"av-tooltip tooltip-label-bottom"},o.a.createElement(u.a,{className:"form-group has-float-label"},o.a.createElement(p.a,null,o.a.createElement(y.a,{id:"user.email"})),o.a.createElement(w.a,{className:"form-control",name:"email"}),e.email&&a.email&&o.a.createElement("div",{className:"invalid-feedback d-block"},e.email)),o.a.createElement(u.a,{className:"form-group has-float-label"},o.a.createElement(p.a,null,o.a.createElement(y.a,{id:"user.password"})),o.a.createElement(w.a,{className:"form-control",type:"password",name:"password",validate:this.validatePassword}),e.password&&a.password&&o.a.createElement("div",{className:"invalid-feedback d-block"},e.password)),o.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},o.a.createElement(g.b,{to:"/user/forgot-password"},o.a.createElement(y.a,{id:"user.forgot-password-question"})),o.a.createElement(d.a,{color:"primary",type:"submit",className:"btn-shadow btn-multiple-state ".concat(this.props.loading?"show-spinner":""),size:"lg"},o.a.createElement("span",{className:"spinner d-inline-block"},o.a.createElement("span",{className:"bounce1"}),o.a.createElement("span",{className:"bounce2"}),o.a.createElement("span",{className:"bounce3"})),o.a.createElement("span",{className:"label"},o.a.createElement(y.a,{id:"user.login-button"})))))),o.a.createElement(f.a,{backdrop:!0,contentClassName:"p-4",centered:!0,isOpen:r,toggle:()=>this.props.toggleAuthenticatorState(this.props.showAuthenticator)},o.a.createElement(h.a,{className:"text-center"},o.a.createElement("h1",null,"Autenticazione Google"),o.a.createElement("div",null,o.a.createElement("p",null,"L'ultimo passaggio \xe8 inserire la password one-time generata dall'App Google Authenticator per verificare la tua identit\xe0."),o.a.createElement(u.a,{className:"has-float-label"},o.a.createElement(p.a,{for:"otp"},"One-Time Password"),o.a.createElement(b.a,{id:"otp",type:"password",onChange:e=>this.setState({oneTimePassword:e.target.value})})),o.a.createElement(d.a,{color:"primary",onClick:()=>this.verifyUser()},"Verify One-Time Password"))))))))}}a.default=Object(E.b)(({authUser:e})=>({user:e.user,loading:e.loading,error:e.error,authenticationServer:e.authenticationServer,clientID:e.clientID,clientSecret:e.clientSecret,qr:e.qr,showAuthenticator:e.showAuthenticator,frontOfficeURL:e.frontOfficeURL}),{toggleAuthenticatorState:x.H,loginUser:x.B,loginUserSuccess:x.C})(O)},92:function(e,a,t){"use strict";t.d(a,"a",(function(){return i})),t.d(a,"b",(function(){return o}));var r=t(1),s=t.n(r),n=t(334);const i=e=>s.a.createElement(n.a,Object.assign({},e,{widths:["xxs","xs","sm","md","lg","xl","xxl"]})),o=e=>s.a.createElement("div",{className:"separator ".concat(e.className)})},95:function(e,a,t){"use strict";var r=t(120),s=(t(114),t(115));t.d(a,"a",(function(){return s.a}));r.a},99:function(e,a,t){"use strict";var r=t(1),s=t.n(r),n=t(103);a.a=Object(n.d)(e=>s.a.createElement(n.a,e),{withRef:!1})}}]);
//# sourceMappingURL=user-login.e2f8ed52.chunk.js.map